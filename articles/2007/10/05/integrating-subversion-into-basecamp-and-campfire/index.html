
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Develop With Style: Integrating Subversion into Basecamp and Campfire</title>
  <meta name="author" content="Joel Moss">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="canonical" href="http://developwithstyle.com/articles/2007/10/05/integrating-subversion-into-basecamp-and-campfire/"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="http://s3.amazonaws.com/ender-js/jeesh.min.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/DevelopingWithStyle" rel="alternate" title="Develop With Style" type="application/atom+xml"/>
  

  

  
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Actor|Quattrocento+Sans' rel='stylesheet' type='text/css'>

<style type="text/css" media="screen">
  .carbonad {
    width: 265px !important;
    height: 98px !important;
  }
  .carbonad-text {
    width: 136px !important;
    padding-top: 8px !important;
  }
  .carbonad-image img {
    width: 110px !important;
    height: 80px !important;
  }
  .carbonad-tag {
    width: 136px !important;
  }
</style>
</head>

<body  >
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/DevelopingWithStyle" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:developwithstyle.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Home</a></li>
  <li><a href="/#contact">Contact</a></li>
  <li><a href="/articles">Blog</a></li>
  <li><a href="http://twitter.com/joelmoss">Twitter</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <header><hgroup>
  <h1><a href="/">Develop With Style</a></h1>
</hgroup>

</header>
      <div>
<article class="hentry">
  
  <header>
    
      <h1 class="entry-title">Integrating Subversion Into Basecamp and Campfire</h1>
    
    
      <p class="meta">




<time datetime="2007-10-05 00:00:00 +0100" pubdate  updated >Oct 5<span>th</span>, 2007</time>


</p>
    
  </header>


<div class="entry-content"><p>For the last few days, I have been thinking about how me and the team around me can improve productivity and communications when developing. Currently, the system we use is a little disjointed, and utilizes several different systems and solutions. Fortunately one such solution is <a href="http://basecamphq.com">Basecamp</a>, which happens to be one of the best around and has been in use by the company for a while now. So after spending a little time with the web based application, I realised that it should be able to do, or at least manage everything we do.</p>

<p>So last night I sat down and played with the <a href="http://developer.37signals.com/basecamp">Basecamp API</a>, to see what could be done with it. And I came up with a post-commit hook for <a href="http://subversion.tigris.org/">Subversion</a>, that posts a message for each subversion commit. This message tells me the change log, what files were changed, and who made the commit. So now we can all see and receive Basecamp notices for every single changeset.</p>

<p>We have also started using <a href="http://www.campfirenow.com/">Campfire</a>, so I then had a little play with <a href="http://opensoul.org/2006/12/8/tinder-campfire-api">Tinder</a>; Campfire&#8217;s unofficial API, and added some more code to the Subversion hook. So as well as creating a message in Basecamp detailing each Changeset, the same changeset is also posted in the appropriate Campfire room. So we have a real time view of our development progress.</p>

<p>So here is the code. It&#8217;s all in Ruby, as it was easy peasy. And it utilises the Basecamp API Wrapper.</p>

<pre lang="ruby"><code>
%w( rubygems tinder basecamp ).each { |f| require f }

config = {
:subdomain =&gt; 'My-Subdomain', # Campfire and Basecamp subdomain
:email =&gt; 'user@mydomain.com', # Campfire email login
:username =&gt; 'username', # Basecamp username
:pass =&gt; 'password',
:room =&gt; 'Development', # Campfire room
:project_id =&gt; 12345, # Basecamp project id
:category_id =&gt; 678910, # Basecamp message category ID
:ssl =&gt; true
}

svnlook = '/usr/bin/svnlook' # full path to the svnlook command
repo_path = ARGV[0]
revision = ARGV[1]
project = repo_path.split('/').last

commit_author = `#{svnlook} author #{repo_path} -r #{revision}`.chop
commit_log = `#{svnlook} log #{repo_path} -r #{revision}`
commit_files = `#{svnlook} changed #{repo_path} -r #{revision}`

# create a message in basecamp
basecamp = Basecamp.new("#{config[:subdomain]}.projectpath.com", config[:username], config[:pass], true)
basecamp.post_message config[:project_id], {
:title =&gt; "Changeset ##{revision}",
:body =&gt; "#{commit_author} just committed changeset ##{revision}...\n\n&lt;blockquote&gt;&lt;pre&gt;#{commit_log}\n#{commit_files}&lt;/pre&gt;&lt;/blockquote&gt;",
:category_id =&gt; config[:category_id]
}

# create a message in campfire
campfire = Tinder::Campfire.new(config[:subdomain], :ssl =&gt; config[:ssl])
campfire.login config[:email], config[:pass]
room = campfire.find_room_by_name config[:room]
room.speak "#{commit_author} just committed changeset ##{revision}..."
room.paste "#{commit_log}\n#{commit_files}"
</code></pre>


<p>Simply copy and paste this into a file called &#8216;post-commit.rb&#8217; and save that in your subversion repository&#8217;s hooks directory. Don&#8217;t forget to set its permissions as required (chmod 755 on linux/unix). Then create another file in your hooks directory and call it &#8216;post-commit&#8217; and do the same with the permissions. In the &#8216;post-commit&#8217; file, paste the following code:</p>

<pre lang="sh"><code>#!/bin/sh

REPOS="$1"
REV="$2"

ruby /Users/joelmoss/dev/src/testing/hooks/campfire.rb "$REPOS" "$REV"
</code></pre>


<p>If &#8216;post-commit&#8217; already exists, just append the last line above to the end of the file.</p>

<p>You will then need to install a few Ruby Gems. Namely Tinder and XML-Simple. So just run the following command:</p>

<pre><code>sudo gem install tinder xml-simple --include-dependencies
</code></pre>


<p>And finally, you will need the <a href="http://developer.37signals.com/basecamp/basecamp.rb">Basecamp API wrapper</a>. You can get that at <a href="http://developer.37signals.com/basecamp/basecamp.rb">http://www.basecamphq.com/api/basecamp.rb</a>. Save that in somewhere in your Ruby path. Ideally, that would be in your &#8216;site<em>ruby&#8217; directly. On my Mac, that is at &#8216;/usr/local/lib/ruby/site</em>ruby/1.8/&#8217;.</p>

<p>And now you should be good to go. As long as you have enabled the API in your Basecamp and your settings are correct, whenever anyone makes a commit to Subversion, you will all be able to see it in Basecamp and Campfire.</p>

<p>I plan to do more with this, as we will need a better bug management system, as Bugzilla is just so damn ugly. But I will leave that to another post.</p>

<p>Enjoy!</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Joel Moss</span></span>

      




<time datetime="2007-10-05 00:00:00 +0100" pubdate  updated >Oct 5<span>th</span>, 2007</time>



      

<span class="categories">
  
    <a class='category' href='/articles/categories/articles/'>articles</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://developwithstyle.com/articles/2007/10/05/integrating-subversion-into-basecamp-and-campfire/" data-via="joelmoss" data-counturl="http://developwithstyle.com/articles/2007/10/05/integrating-subversion-into-basecamp-and-campfire/" >Tweet</a>
  
  
</div>

    
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread"><div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'dws';
  var disqus_identifier = 'http://developwithstyle.com/articles/2007/10/05/integrating-subversion-into-basecamp-and-campfire/';
  var disqus_url = 'http://developwithstyle.com/articles/2007/10/05/integrating-subversion-into-basecamp-and-campfire/';
  //var disqus_developer = 1;
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside role=sidebar>
  
    <header><hgroup>
  <h1><a href="/">Develop With Style</a></h1>
</hgroup>

</header><section>
  <h1>About Me</h1>
  <p>This site contains the musings of Joel Moss, a web developer of some 13 years; living in Manchester, England. But some say I&#8217;m physically plugged into, and live IN the internet! They may actually be right!</p>
  <p><a href="/">Tell me more&#8230;</a></p>
</section>
<div id="carbonads-container"><div class="carbonad"><div id="carbon"></div><script type="text/javascript">var z = document.createElement("script"); z.type = "text/javascript"; z.async = true; z.src = "http://engine.carbonads.com/z/12107/carbon_2_1_0_HORIZ"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(z, s);</script></div></div> <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/articles/2011/07/12/the-right-way-to-create-an-api/">The Right Way to Create an API</a>
      </li>
    
      <li class="post">
        <a href="/articles/2010/10/28/from-zero-to-hero-how-i-built-twitious-in-two-weeks/">From Zero to Hero: How I built Twitious in Two Weeks</a>
      </li>
    
      <li class="post">
        <a href="/articles/2010/08/09/dynamic-form-and-dynamic-errors-for-rails-3/">Dynamic Form and Dynamic Errors for Rails 3</a>
      </li>
    
      <li class="post">
        <a href="/articles/2010/07/09/handling-dates-in-mongodb/">Handling Dates in MongoDB</a>
      </li>
    
      <li class="post">
        <a href="/articles/2010/06/29/converting-html-entities-to-characters/">Converting HTML Entities to Characters with Javascript</a>
      </li>
    
      <li class="post">
        <a href="/articles/2010/05/14/jquery-ui-autocomplete-is-it-any-good/">jQuery UI Autocomplete and Caching Query Results</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("joelmoss", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/joelmoss" class="twitter-follow-button" data-width="208px" data-show-count="true">Follow @joelmoss</a>
  
</section>


  
</aside>


    </div>
  </div>
  <footer><p>
  Copyright &copy; 2011 - Joel Moss -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
</body>
</html>
